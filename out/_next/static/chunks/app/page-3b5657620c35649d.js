(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{4530:()=>{},8108:()=>{},18590:()=>{},41234:()=>{},46433:(e,t,a)=>{"use strict";a.d(t,{default:()=>u});var r=a(95155),l=a(12115),c=a(80876),s=a(14426),i=a(72841),n=a(62995);a(24590);let o={person:"人",bicycle:"自行车",car:"汽车",motorcycle:"摩托车",airplane:"飞机",bus:"公交车",train:"火车",truck:"卡车",boat:"船","traffic light":"交通灯","fire hydrant":"消防栓","stop sign":"停止标志","parking meter":"停车表",bench:"长凳",bird:"鸟",cat:"猫",dog:"狗",horse:"马",sheep:"羊",cow:"牛",elephant:"大象",bear:"熊",zebra:"斑马",giraffe:"长颈鹿",backpack:"背包",umbrella:"雨伞",handbag:"手提包",tie:"领带",suitcase:"手提箱",frisbee:"飞盘",skis:"滑雪板",snowboard:"滑雪双杖","sports ball":"滑板",kite:"冲浪板","baseball bat":"网球拍",bottle:"瓶子","wine glass":"葡萄酒杯",cup:"杯子",fork:"叉子",knife:"刀子",spoon:"勺子",bowl:"碗",banana:"香蕉",apple:"苹果",sandwich:"三明治",orange:"橙子",broccoli:"西兰花",carrot:"胡萝卜","hot dog":"热狗",pizza:"比萨饼",donut:"甜甜圈",cake:"蛋糕",chair:"椅子",couch:"沙发","potted plant":"盆栽植物",bed:"床","dining table":"餐桌",toilet:"厕所",tv:"电视",laptop:"笔记本电脑",mouse:"鼠标",remote:"遥控器",keyboard:"键盘","cell phone":"手机",microwave:"微波炉",oven:"烤箱",toaster:"烤面包机",sink:"水槽",refrigerator:"冰箱",book:"书",clock:"时钟",vase:"花瓶",scissors:"剪刀","teddy bear":"泰迪熊","hair drier":"吹风机",toothbrush:"牙刷"};function u(){let e=(0,l.useRef)(null),t=(0,l.useRef)(null),[a,u]=(0,l.useState)(null),[d,b]=(0,l.useState)("environment"),[h,f]=(0,l.useState)(!0),p=(0,l.useCallback)(async()=>{f(!0),u(await n.load()),f(!1),console.log("模型加载完成")},[]),m=(0,l.useCallback)(async t=>{try{let a=await navigator.mediaDevices.getUserMedia({video:{facingMode:t},audio:!1});e.current&&(e.current.srcObject=a,await e.current.play())}catch(e){console.error("启动摄像头失败",e)}},[]),v=(0,l.useCallback)(()=>{var t;let a=null==(t=e.current)?void 0:t.srcObject;a&&(a.getTracks().forEach(e=>e.stop()),e.current&&(e.current.srcObject=null))},[]),k=(0,l.useCallback)(a=>{let r=t.current,l=e.current;if(!r||!l)return;let c=r.getContext("2d");c&&(r.width=l.videoWidth,r.height=l.videoHeight,c.clearRect(0,0,r.width,r.height),a.forEach(e=>{let[t,a,r,l]=e.bbox,s=o[e.class]||e.class;c.strokeStyle="#00FFFF",c.lineWidth=2,c.strokeRect(t,a,r,l),c.font="16px Arial",c.fillStyle="#00FFFF",c.fillText("".concat(s," (").concat((100*e.score).toFixed(1),"%)"),t,a>10?a-5:10)}))},[]);return(0,l.useEffect)(()=>{p()},[p]),(0,l.useEffect)(()=>(m(d),()=>{v()}),[d,m,v]),(0,l.useEffect)(()=>{let t=()=>!!e.current&&!!(e.current.videoWidth>0)&&!!(e.current.videoHeight>0),r=async()=>{if(a&&e.current&&t()){let r,l=0,c=async()=>{e.current&&t()&&(l%3==0&&k(await a.detect(e.current)),l++,r=requestAnimationFrame(c))};return c(),()=>{cancelAnimationFrame(r)}}setTimeout(r,100)};r()},[a,k]),(0,r.jsxs)("div",{className:"flex flex-col items-center justify-center p-4 space-y-4",children:[(0,r.jsx)(c.A,{variant:"contained",color:"primary",onClick:()=>{b(e=>"user"===e?"environment":"user")},className:"!rounded-xl !px-6 !py-3",children:"切换摄像头"}),(0,r.jsxs)("div",{className:"relative w-full max-w-2xl rounded-xl overflow-hidden shadow-lg border border-gray-200 mt-3",children:[(0,r.jsx)("video",{ref:e,className:"w-full h-auto",muted:!0,autoPlay:!0,playsInline:!0}),(0,r.jsx)("canvas",{ref:t,className:"absolute top-0 left-0 w-full h-full"}),h&&(0,r.jsx)("div",{className:"absolute inset-0 flex items-center justify-center bg-black bg-opacity-30 rounded-xl",children:(0,r.jsxs)("div",{className:"flex flex-col items-center",children:[(0,r.jsx)(s.A,{color:"primary",size:50}),(0,r.jsx)(i.A,{variant:"h6",className:"mt-2 text-white",children:"模型加载中..."})]})})]})]})}},49605:(e,t,a)=>{Promise.resolve().then(a.bind(a,46433))},80551:()=>{},85817:()=>{}},e=>{var t=t=>e(e.s=t);e.O(0,[690,272,660,56,87,251,674,204,441,684,358],()=>t(49605)),_N_E=e.O()}]);